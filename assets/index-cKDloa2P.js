import{r as i,j as e,u as O,L as I,B as ee,C as ce,a as de,b as me,U as q,c as xe,N as ue,F as ge,S as he,H as W,M as te,E as pe,d as fe,W as be,e as je,f as ye,g as X,h as ve,i as we,V as Ne,P as Se,k as ke,l as Ce,m as Ie,T as ze,n as Le,o as $e,p as Ae,q as De,s as se,t as re,v as ae,I as Me,w as ne,x as Ee,y as Pe,z as Te,A as Ue,D as Oe,R as Fe,G as D,J as Re,K as Ge}from"./react-D_RA_leT.js";import{m as k,A as M,G as Ve}from"./vendor-6VA_vAAo.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function d(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=d(s);fetch(s.href,r)}})();function R(t,l){const[d,n]=i.useState(()=>{try{const r=window.localStorage.getItem(t);return r?JSON.parse(r):l}catch(r){return console.error(r),l}}),s=r=>{try{const a=r instanceof Function?r(d):r;n(a),window.localStorage.setItem(t,JSON.stringify(a))}catch(a){console.error(a)}};return i.useEffect(()=>{const r=a=>{if(a.key===t)try{n(a.newValue?JSON.parse(a.newValue):l)}catch(x){console.error(x),n(l)}};return window.addEventListener("storage",r),()=>{window.removeEventListener("storage",r)}},[t,l]),[d,s]}const _e=()=>({initialUsers:[{id:"user-1",name:"مؤلف تجريبي",avatar:"https://picsum.photos/seed/user1/100/100"},{id:"user-2",name:"عاشق الفضاء",avatar:"https://picsum.photos/seed/user2/100/100"},{id:"user-3",name:"أسطورة الخيال",avatar:"https://picsum.photos/seed/user3/100/100"}],initialStories:[]}),oe=i.createContext(void 0),He=({children:t})=>{const{initialUsers:l,initialStories:d}=_e(),[n,s]=R("hakayat_users",l),[r,a]=R("hakayat_stories",d),[x,u]=R("hakayat_currentUser",null),[b,o]=R("hakayat_notifications",[]),[c,y]=R("hakayat_user_meta",{}),h=i.useCallback(p=>{let m=n.find(g=>g.name.toLowerCase()===p.toLowerCase());return m||(m={id:`user-${Date.now()}`,name:p,avatar:`https://picsum.photos/seed/${p}/100/100`},s(g=>[...g,m])),u(m),m},[n,s,u]),z=i.useCallback(()=>{u(null)},[u]),N=i.useCallback((p,m)=>{s(g=>g.map(v=>v.id===p?{...v,avatar:m}:v)),(x==null?void 0:x.id)===p&&u(g=>g?{...g,avatar:m}:null)},[s,x,u]),C=i.useCallback(p=>n.find(m=>m.id===p),[n]),j=i.useCallback(p=>r.find(m=>m.id===p),[r]),w=i.useCallback(p=>{const m=`viewed_story_${p}`;sessionStorage.getItem(m)||(a(g=>g.map(v=>v.id===p?{...v,views:v.views+1}:v)),sessionStorage.setItem(m,"true"))},[a]),f=i.useCallback(p=>{const m={...p,id:`notif-${Date.now()}`,timestamp:new Date().toISOString()};o(g=>[m,...g].slice(0,50))},[o]),S=i.useCallback(p=>{const m={...p,id:`story-${Date.now()}`,createdAt:new Date().toISOString(),views:0,likes:[],comments:[]};return a(g=>[m,...g]),f({storyId:m.id,storyTitle:m.title,authorId:m.authorId}),m},[a,f]),P=i.useCallback(p=>{a(m=>m.map(g=>g.id===p.id?p:g))},[a]),A=i.useCallback(p=>{a(m=>m.filter(g=>g.id!==p))},[a]),V=i.useCallback((p,m)=>{a(g=>g.map(v=>{if(v.id===p){const T=v.likes.includes(m)?v.likes.filter(le=>le!==m):[...v.likes,m];return{...v,likes:T}}return v}))},[a]),F=i.useCallback((p,m)=>{const g={...m,id:`comment-${Date.now()}`,createdAt:new Date().toISOString()};a(v=>v.map(T=>T.id===p?{...T,comments:[g,...T.comments]}:T))},[a]),_=i.useMemo(()=>{var g;if(!x)return 0;const p=(g=c[x.id])==null?void 0:g.lastNotificationCheck;if(!p)return b.length;const m=new Date(p);return b.filter(v=>new Date(v.timestamp)>m).length},[b,x,c]),H=i.useCallback(()=>{x&&y(p=>({...p,[x.id]:{...p[x.id],lastNotificationCheck:new Date().toISOString()}}))},[x,y]),B={users:n,stories:r,currentUser:x,login:h,logout:z,updateUserAvatar:N,getStory:j,incrementStoryView:w,createStory:S,updateStory:P,deleteStory:A,toggleLike:V,addComment:F,getUser:C,notifications:b,unreadCount:_,markNotificationsAsRead:H};return e.jsx(oe.Provider,{value:B,children:t})},L=()=>{const t=i.useContext(oe);if(t===void 0)throw new Error("useAppContext must be used within an AppProvider");return t},E=({src:t,alt:l,size:d="md"})=>{const n={sm:"h-8 w-8",md:"h-12 w-12",lg:"h-24 w-24"};return e.jsx("img",{src:t,alt:l,className:`${n[d]} rounded-full object-cover border-2 border-amber-500/50`})},Z=({to:t,children:l,className:d,title:n})=>{const r=xe().pathname===t;return e.jsx(I,{to:t,title:n,className:`flex items-center gap-2 text-gray-300 hover:text-amber-400 p-2 rounded-md transition-colors ${r?"bg-gray-800":""} ${d}`,children:l})},Be=t=>{const l=new Date(t),n=Math.floor((new Date().getTime()-l.getTime())/1e3);let s=n/31536e3;return s>1?`منذ ${Math.floor(s)} سنة`:(s=n/2592e3,s>1?`منذ ${Math.floor(s)} شهر`:(s=n/86400,s>1?`منذ ${Math.floor(s)} يوم`:(s=n/3600,s>1?`منذ ${Math.floor(s)} ساعة`:(s=n/60,s>1?`منذ ${Math.floor(s)} دقيقة`:"الآن"))))},Je=({onClose:t})=>{const{notifications:l,getUser:d}=L(),n=O(),s=r=>{n(`/story/${r}`),t()};return e.jsxs("div",{className:"absolute top-full mt-2 end-0 w-80 bg-gray-900 border border-gray-700 rounded-lg shadow-lg z-50",children:[e.jsx("div",{className:"p-3 font-bold text-white border-b border-gray-700",children:"الإشعارات"}),e.jsx("ul",{className:"max-h-96 overflow-y-auto",children:l.length>0?l.map(r=>{const a=d(r.authorId);return e.jsx("li",{className:"border-b border-gray-800 last:border-b-0",children:e.jsxs("button",{onClick:()=>s(r.storyId),className:"w-full text-right flex items-start gap-3 p-3 hover:bg-gray-800 transition-colors",children:[e.jsx(E,{src:(a==null?void 0:a.avatar)||"",alt:(a==null?void 0:a.name)||"مستخدم",size:"sm"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm text-gray-200",children:[e.jsx("span",{className:"font-bold",children:(a==null?void 0:a.name)||"مستخدم"})," نشر قصة جديدة: ",e.jsxs("span",{className:"text-amber-400 font-semibold",children:['"',r.storyTitle,'"']})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Be(r.timestamp)})]})]})},r.id)}):e.jsx("li",{className:"p-4 text-center text-gray-500",children:"لا توجد إشعارات بعد."})})]})},Ke=()=>{const{currentUser:t,logout:l,unreadCount:d,markNotificationsAsRead:n}=L(),s=O(),[r,a]=i.useState(!1),x=i.useRef(null),u=()=>{l(),s("/")},b=()=>{a(o=>{const c=!o;return c&&d>0&&n(),c})};return i.useEffect(()=>{const o=c=>{x.current&&!x.current.contains(c.target)&&a(!1)};return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[x]),e.jsx("header",{className:"bg-gray-950/70 backdrop-blur-lg sticky top-0 z-40 shadow-md shadow-amber-500/10",children:e.jsxs("nav",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[e.jsx(I,{to:"/",className:"text-2xl font-bold text-amber-400 tracking-wider",children:"حكايات"}),e.jsx("div",{className:"flex items-center gap-2 sm:gap-4",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(Z,{to:"/generate",title:"إنشاء بالذكاء الاصطناعي",children:[e.jsx(ee,{size:20}),e.jsx("span",{className:"hidden sm:inline",children:"إنشاء AI"})]}),e.jsxs(Z,{to:"/create",title:"قصة جديدة",children:[e.jsx(ce,{size:20}),e.jsx("span",{className:"hidden sm:inline",children:"قصة جديدة"})]}),e.jsx("div",{className:"h-6 w-px bg-gray-700 mx-2"}),e.jsxs("div",{className:"relative",ref:x,children:[e.jsxs("button",{onClick:b,className:"relative text-gray-400 hover:text-amber-400 transition-colors p-2 rounded-full hover:bg-gray-800",title:"الإشعارات",children:[e.jsx(de,{size:20}),d>0&&e.jsxs("span",{className:"absolute top-1 right-1 flex h-2.5 w-2.5",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-500"})]})]}),r&&e.jsx(Je,{onClose:()=>a(!1)})]}),e.jsxs(I,{to:`/profile/${t.id}`,className:"flex items-center gap-2 p-1 rounded-full hover:bg-gray-800 transition-colors",children:[e.jsx(E,{src:t.avatar,alt:t.name,size:"sm"}),e.jsx("span",{className:"font-medium hover:text-amber-400 transition-colors hidden md:inline",children:t.name})]}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-amber-400 transition-colors p-2 rounded-full hover:bg-gray-800",title:"تسجيل الخروج",children:e.jsx(me,{size:20})})]}):e.jsxs(I,{to:"/login",className:"flex items-center gap-2 bg-amber-500 text-gray-900 px-4 py-2 rounded-md hover:bg-amber-400 transition-colors font-bold",children:[e.jsx(q,{size:20}),e.jsx("span",{children:"تسجيل الدخول"})]})})]})})},qe=({children:t})=>e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100 font-sans",children:[e.jsx(Ke,{}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:t})]}),J=({children:t})=>{const{currentUser:l}=L();return l?e.jsx(e.Fragment,{children:t}):e.jsx(ue,{to:"/login",replace:!0})},G=({story:t,isMostViewed:l,isMostLiked:d})=>{const{getUser:n}=L(),s=n(t.authorId);return e.jsxs(k.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-gray-900 rounded-lg overflow-hidden shadow-lg hover:shadow-amber-500/20 transition-all duration-300 flex flex-col group relative hover:-translate-y-1",children:[e.jsxs("div",{className:"overflow-hidden relative",children:[e.jsxs(I,{to:`/story/${t.id}`,className:"block relative",children:[e.jsx("img",{src:t.coverImage||`https://picsum.photos/seed/${t.id}/400/200`,alt:t.title,className:"w-full h-48 object-cover transform transition-transform duration-500 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-2 z-10",children:[d&&e.jsx(k.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,type:"spring",stiffness:200,damping:15},title:"الأكثر إعجاباً",className:"bg-red-500/80 backdrop-blur-sm text-white h-7 w-7 flex items-center justify-center rounded-full shadow-lg",children:e.jsx(ge,{size:16})}),l&&e.jsx(k.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,type:"spring",stiffness:200,damping:15},title:"الأكثر مشاهدة",className:"bg-amber-400/80 backdrop-blur-sm text-white h-7 w-7 flex items-center justify-center rounded-full shadow-lg",children:e.jsx(he,{size:16})})]})]}),e.jsxs("div",{className:"p-4 flex flex-col flex-grow",children:[e.jsx("span",{className:"text-sm text-amber-400 font-semibold",children:t.category}),e.jsx(I,{to:`/story/${t.id}`,className:"block flex-grow",children:e.jsx("h3",{className:"text-xl font-bold mt-1 mb-2 text-gray-100 group-hover:text-amber-300 transition-colors",children:t.title})}),e.jsxs("p",{className:"text-gray-400 text-sm line-clamp-2 mt-auto",children:[t.content.substring(0,100),"..."]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 flex justify-between items-center",children:[s&&e.jsxs(I,{to:`/profile/${s.id}`,className:"flex items-center gap-2 group/author",children:[e.jsx(E,{src:s.avatar,alt:s.name,size:"sm"}),e.jsx("span",{className:"text-sm font-medium text-gray-300 group-hover/author:text-white transition-colors",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",title:"الإعجابات",children:[e.jsx(W,{size:14})," ",t.likes.length]}),e.jsxs("span",{className:"flex items-center gap-1",title:"التعليقات",children:[e.jsx(te,{size:14})," ",t.comments.length]}),e.jsxs("span",{className:"flex items-center gap-1",title:"المشاهدات",children:[e.jsx(pe,{size:14})," ",t.views]})]})]})]})]})};var $=(t=>(t.Adventure="مغامرات",t.SciFi="خيال علمي",t.Fantasy="خيال",t.Romance="رومانسي",t.Mystery="غموض",t.Horror="رعب",t.Comedy="كوميدي",t.Drama="دراما",t))($||{});const U=[$.Adventure,$.SciFi,$.Fantasy,$.Romance,$.Mystery,$.Horror,$.Comedy,$.Drama],K=({children:t})=>e.jsx("h2",{className:"text-3xl font-bold text-white mb-6",children:e.jsx("span",{className:"bg-gradient-to-r from-amber-400 to-amber-500 bg-clip-text text-transparent",children:t})}),We=()=>{const{stories:t,getUser:l}=L(),[d,n]=i.useState(""),[s,r]=i.useState("all"),a=i.useMemo(()=>{const o=[...t].sort((y,h)=>h.views-y.views),c=[...t].sort((y,h)=>h.likes.length-y.likes.length);return{mostViewedIds:o.slice(0,3).map(y=>y.id),mostLikedIds:c.slice(0,3).map(y=>y.id)}},[t]),x=i.useMemo(()=>t.filter(o=>{const c=l(o.authorId),y=s==="all"||o.category===s,h=o.title.toLowerCase().includes(d.toLowerCase())||o.content.toLowerCase().includes(d.toLowerCase())||c&&c.name.toLowerCase().includes(d.toLowerCase());return y&&h}),[t,d,s,l]),u=i.useMemo(()=>[...t].sort((o,c)=>c.views+c.likes.length*5-(o.views+o.likes.length*5)).slice(0,4),[t]),b=i.useMemo(()=>[...t].sort((o,c)=>new Date(c.createdAt).getTime()-new Date(o.createdAt).getTime()).slice(0,4),[t]);return e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:[e.jsxs("div",{className:"relative rounded-lg overflow-hidden mb-16 text-center h-[50vh] flex flex-col justify-center items-center p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-[url('https://picsum.photos/seed/hero/1200/600')] opacity-20"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 to-transparent"}),e.jsxs(k.div,{className:"relative z-10",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.7,delay:.2},children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-extrabold text-white leading-tight shadow-black [text-shadow:_0_2px_4px_var(--tw-shadow-color)]",children:"حيث تولد الكلمات عوالم جديدة"}),e.jsx("p",{className:"text-lg text-gray-300 mt-4 max-w-2xl mx-auto",children:'منصة "حكايات" هي بوابتك لقراءة ومشاركة وتوليد أروع القصص. انطلق في رحلة إبداعية لا حدود لها.'}),e.jsxs("div",{className:"mt-8 flex justify-center gap-4",children:[e.jsxs(I,{to:"/create",className:"flex items-center gap-2 bg-amber-500 text-gray-900 px-6 py-3 rounded-lg hover:bg-amber-400 transition-all font-bold text-lg transform hover:scale-105",children:[e.jsx(fe,{}),e.jsx("span",{children:"اكتب قصتك"})]}),e.jsxs(I,{to:"/generate",className:"flex items-center gap-2 bg-gray-700 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-all font-bold text-lg transform hover:scale-105",children:[e.jsx(be,{}),e.jsx("span",{children:"استعن بالذكاء الاصطناعي"})]})]})]})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(K,{children:"الأكثر رواجاً"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:e.jsx(M,{children:u.map(o=>e.jsx(G,{story:o,isMostViewed:a.mostViewedIds.includes(o.id),isMostLiked:a.mostLikedIds.includes(o.id)},o.id))})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx(K,{children:"أحدث القصص"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:e.jsx(M,{children:b.map(o=>e.jsx(G,{story:o,isMostViewed:a.mostViewedIds.includes(o.id),isMostLiked:a.mostLikedIds.includes(o.id)},o.id))})})]}),e.jsxs("section",{children:[e.jsx(K,{children:"كل القصص"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8 p-4 bg-gray-900/70 rounded-lg border border-gray-800",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"text",placeholder:"ابحث عن قصة، محتوى، أو مؤلف...",value:d,onChange:o=>n(o.target.value),className:"w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-2 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500 transition-colors"}),e.jsx(je,{className:"absolute top-1/2 -translate-y-1/2 start-3 text-gray-400",size:20})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:s,onChange:o=>r(o.target.value),className:"w-full md:w-auto appearance-none bg-gray-800 border-2 border-gray-700 rounded-lg py-2 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500 transition-colors",children:[e.jsx("option",{value:"all",children:"كل التصنيفات"}),U.map(o=>e.jsx("option",{value:o,children:o},o))]}),e.jsx(ye,{className:"absolute top-1/2 -translate-y-1/2 start-3 text-gray-400",size:20})]})]}),e.jsx(M,{children:x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:x.map(o=>e.jsx(G,{story:o,isMostViewed:a.mostViewedIds.includes(o.id),isMostLiked:a.mostLikedIds.includes(o.id)},o.id))}):e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"text-gray-400 col-span-full text-center py-16 bg-gray-900 rounded-lg",children:[e.jsx("p",{className:"text-xl",children:"لم يتم العثور على قصص تطابق بحثك."}),e.jsx("p",{className:"text-gray-500 mt-2",children:"جرّب كلمة بحث مختلفة أو قم بتغيير التصنيف."})]})})]})]})},Y=()=>e.jsx("div",{className:"flex justify-center items-center h-full w-full",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-amber-500"})}),Xe=t=>{const[l,d]=i.useState(0),n=i.useCallback(()=>{if(!t.current)return;const s=t.current,r=s.clientHeight,a=window.innerHeight,x=window.scrollY,u=s.offsetTop;if(x<u){d(0);return}if(x>u+r-a){d(100);return}const b=x-u,o=r-a;if(o<=0){d(100);return}const c=b/o*100;d(c)},[t]);return i.useEffect(()=>(window.addEventListener("scroll",n),()=>window.removeEventListener("scroll",n)),[n]),l},Ye=t=>{const[l,d]=i.useState(!1),[n,s]=i.useState(!1),r=i.useCallback(()=>{window.speechSynthesis.cancel(),d(!1),s(!1)},[]),a=i.useCallback(()=>{if(l&&n){window.speechSynthesis.resume(),s(!1);return}r();const u=new SpeechSynthesisUtterance(t);u.lang="ar-SA",u.onstart=()=>{d(!0),s(!1)},u.onend=()=>{d(!1),s(!1)},u.onerror=b=>{console.error("Speech synthesis error",b),d(!1),s(!1)},window.speechSynthesis.speak(u)},[t,l,n,r]),x=i.useCallback(()=>{l&&!n&&(window.speechSynthesis.pause(),s(!0))},[l,n]);return i.useEffect(()=>()=>{r()},[r]),{isSpeaking:l,isPaused:n,play:a,pause:x,stop:r}},Ze=()=>{const{storyId:t}=X(),l=O(),{getStory:d,getUser:n,currentUser:s,toggleLike:r,addComment:a,deleteStory:x,incrementStoryView:u,stories:b}=L(),o=i.useMemo(()=>t?d(t):void 0,[t,b,d]),[c,y]=i.useState(o),[h,z]=i.useState("");i.useEffect(()=>{t&&u(t)},[t,u]),i.useEffect(()=>{y(o)},[o]);const N=i.useMemo(()=>c?n(c.authorId):void 0,[c,n]),C=i.useRef(null),j=Xe(C),{isSpeaking:w,isPaused:f,play:S,pause:P,stop:A}=Ye((c==null?void 0:c.content)||"");if(!c||!N)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(Y,{})});const V=(s==null?void 0:s.id)===N.id,F=s?c.likes.includes(s.id):!1,_=()=>{if(s){r(c.id,s.id);const m=F?c.likes.filter(g=>g!==s.id):[...c.likes,s.id];y(g=>g?{...g,likes:m}:void 0)}else l("/login")},H=m=>{if(m.preventDefault(),h.trim()&&s){a(c.id,{authorId:s.id,content:h});const g={id:`temp-${Date.now()}`,authorId:s.id,content:h,createdAt:new Date().toISOString()};y(v=>v?{...v,comments:[g,...v.comments]}:void 0),z("")}else s||l("/login")},B=()=>{window.confirm("هل أنت متأكد من أنك تريد حذف هذه القصة؟ لا يمكن التراجع عن هذا الإجراء.")&&(x(c.id),l("/"))},p=Math.ceil(c.content.split(" ").length/200);return e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 bg-amber-500 z-50 transition-transform duration-150",style:{transform:`scaleX(${j/100})`,transformOrigin:"right"}}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("span",{className:"text-amber-400 font-semibold",children:c.category}),e.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-white mt-2 mb-4",children:c.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2 text-gray-400",children:[e.jsxs(I,{to:`/profile/${N.id}`,className:"flex items-center gap-2 hover:text-white transition-colors",children:[e.jsx(E,{src:N.avatar,alt:N.name,size:"sm"}),e.jsx("span",{children:N.name})]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ve,{size:16})," ",new Date(c.createdAt).toLocaleDateString("ar-EG")]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(we,{size:16})," قراءة ",p," دقائق"]})]})]}),e.jsx("img",{src:c.coverImage||`https://picsum.photos/seed/${c.id}/800/400`,alt:c.title,className:"w-full h-64 md:h-96 object-cover rounded-lg mb-8 shadow-lg shadow-black/30"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 mb-8 p-3 bg-gray-900 rounded-lg border border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:_,className:`flex items-center gap-2 px-3 py-2 rounded-md transition-all duration-300 ${F?"text-amber-400 bg-amber-500/10 ring-1 ring-amber-500/30":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(W,{size:20,className:F?"fill-current":""}),e.jsx("span",{children:c.likes.length})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-300 px-3 py-2",children:[e.jsx(te,{size:20}),e.jsx("span",{children:c.comments.length})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center gap-2 text-amber-400",children:e.jsx(Ne,{size:20})}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-800 p-1 rounded-full",children:[e.jsx("button",{onClick:S,disabled:w&&!f,className:"p-2 disabled:opacity-50 text-gray-300 hover:text-green-400 rounded-full hover:bg-gray-700 transition-colors",children:e.jsx(Se,{size:20})}),e.jsx("button",{onClick:P,disabled:!w||f,className:"p-2 disabled:opacity-50 text-gray-300 hover:text-yellow-400 rounded-full hover:bg-gray-700 transition-colors",children:e.jsx(ke,{size:20})}),e.jsx("button",{onClick:A,disabled:!w,className:"p-2 disabled:opacity-50 text-gray-300 hover:text-red-400 rounded-full hover:bg-gray-700 transition-colors",children:e.jsx(Ce,{size:20})})]}),e.jsx("div",{className:"w-px h-6 bg-gray-700 mx-2"}),V&&e.jsxs(e.Fragment,{children:[e.jsx(I,{to:`/edit/${c.id}`,className:"p-2 text-gray-300 hover:text-amber-400 rounded-full hover:bg-gray-700 transition-colors",title:"تعديل القصة",children:e.jsx(Ie,{size:20})}),e.jsx("button",{onClick:B,className:"p-2 text-gray-300 hover:text-red-500 rounded-full hover:bg-gray-700 transition-colors",title:"حذف القصة",children:e.jsx(ze,{size:20})}),e.jsx("div",{className:"w-px h-6 bg-gray-700 mx-2"})]}),e.jsxs("div",{className:"dropdown dropdown-end",children:[e.jsx("label",{tabIndex:0,className:"p-2 cursor-pointer text-gray-300 hover:text-amber-400 rounded-full hover:bg-gray-700 transition-colors",children:e.jsx(Le,{size:20})}),e.jsxs("ul",{tabIndex:0,className:"dropdown-content menu p-2 shadow bg-gray-800 border border-gray-700 rounded-box w-52 z-10",children:[e.jsx("li",{children:e.jsxs("a",{href:`https://twitter.com/intent/tweet?url=${window.location.href}&text=${c.title}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx($e,{size:16,className:"me-2"})," تويتر"]})}),e.jsx("li",{children:e.jsxs("a",{href:`https://www.facebook.com/sharer/sharer.php?u=${window.location.href}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ae,{size:16,className:"me-2"})," فيسبوك"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>navigator.clipboard.writeText(window.location.href),children:[e.jsx(De,{size:16,className:"me-2"})," نسخ الرابط"]})})]})]})]})]}),e.jsx("article",{ref:C,className:"prose prose-invert prose-lg max-w-none prose-p:my-6 prose-headings:my-8 prose-li:my-2 leading-loose whitespace-pre-wrap",children:c.content}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-800",children:[e.jsxs("h3",{className:"text-2xl font-bold text-white mb-6",children:["التعليقات (",c.comments.length,")"]}),e.jsx("div",{className:"p-4 mb-8 bg-gray-900 rounded-lg border border-gray-800",children:e.jsxs("form",{onSubmit:H,className:"flex gap-4 items-start",children:[s?e.jsx(E,{src:s.avatar,alt:s.name,size:"md"}):e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-800 flex items-center justify-center",children:e.jsx(q,{className:"text-gray-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:h,onChange:m=>z(m.target.value),placeholder:s?"أضف تعليقك...":"الرجاء تسجيل الدخول للتعليق",className:"w-full bg-gray-800 border-2 border-gray-700 rounded-lg p-3 text-white focus:outline-none focus:border-amber-500 transition-colors",rows:3,disabled:!s}),s&&e.jsx("button",{type:"submit",disabled:!h.trim(),className:"mt-2 bg-amber-500 text-gray-900 font-bold px-6 py-2 rounded-lg hover:bg-amber-400 disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors",children:"إرسال"})]})]})}),e.jsx("div",{className:"space-y-6",children:c.comments.map(m=>{const g=n(m.authorId);return g?e.jsxs("div",{className:"flex gap-4",children:[e.jsx(I,{to:`/profile/${g.id}`,children:e.jsx(E,{src:g.avatar,alt:g.name,size:"md"})}),e.jsxs("div",{className:"flex-1 bg-gray-900 p-4 rounded-lg border border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(I,{to:`/profile/${g.id}`,className:"font-bold text-amber-400 hover:underline",children:g.name}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(m.createdAt).toLocaleString("ar-EG")})]}),e.jsx("p",{className:"text-gray-300 whitespace-pre-wrap",children:m.content})]})]},m.id):null})})]})]})]})},Q=()=>{const{storyId:t}=X(),l=O(),{createStory:d,updateStory:n,getStory:s,currentUser:r}=L(),[a,x]=i.useState(""),[u,b]=i.useState(""),[o,c]=i.useState(U[0]),[y,h]=i.useState(void 0),[z,N]=i.useState(""),C=!!t;i.useEffect(()=>{if(C){const f=s(t);f&&(r==null?void 0:r.id)===f.authorId?(x(f.title),b(f.content),c(f.category),h(f.coverImage)):l("/")}},[C,t,s,r,l]);const j=f=>{var P;const S=(P=f.target.files)==null?void 0:P[0];if(S&&S.type.startsWith("image/")){const A=new FileReader;A.onloadend=()=>{h(A.result)},A.readAsDataURL(S)}else N("الرجاء اختيار ملف صورة صالح.")},w=f=>{if(f.preventDefault(),!a.trim()||!u.trim()){N("العنوان والمحتوى حقول إلزامية.");return}if(!r){N("يجب أن تكون مسجلاً للدخول لنشر قصة.");return}if(N(""),C&&t){const S=s(t);S&&(n({...S,title:a,content:u,category:o,coverImage:y}),l(`/story/${t}`))}else{const S=d({title:a,content:u,category:o,coverImage:y,authorId:r.id});l(`/story/${S.id}`)}};return e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0},className:"max-w-3xl mx-auto p-8 bg-gray-900 rounded-xl shadow-lg border border-gray-800",children:[e.jsx("h1",{className:"text-3xl font-bold text-amber-400 mb-6",children:C?"تعديل القصة":"اكتب قصتك الجديدة"}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-gray-300 mb-2 font-medium",children:"العنوان"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"title",type:"text",value:a,onChange:f=>x(f.target.value),className:"w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-3 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500 transition-colors",placeholder:"عنوان جذاب لقصتك..."}),e.jsx(se,{className:"absolute top-1/2 -translate-y-1/2 start-3 text-gray-400",size:20})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"content",className:"block text-gray-300 mb-2 font-medium",children:"المحتوى"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{id:"content",value:u,onChange:f=>b(f.target.value),className:"w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-3 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500 transition-colors",rows:15,placeholder:"اطلق العنان لخيالك..."}),e.jsx(re,{className:"absolute top-4 start-3 text-gray-400",size:20})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-gray-300 mb-2 font-medium",children:"التصنيف"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{id:"category",value:o,onChange:f=>c(f.target.value),className:"appearance-none w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-3 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500 transition-colors",children:U.map(f=>e.jsx("option",{value:f,children:f},f))}),e.jsx(ae,{className:"absolute top-1/2 -translate-y-1/2 start-3 text-gray-400",size:20})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"coverImage",className:"block text-gray-300 mb-2 font-medium",children:"صورة الغلاف (اختياري)"}),e.jsx("div",{className:"relative flex items-center justify-center w-full",children:e.jsxs("label",{htmlFor:"coverImage",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-700 border-dashed rounded-lg cursor-pointer bg-gray-800 hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Me,{className:"w-8 h-8 mb-2 text-gray-500"}),e.jsxs("p",{className:"mb-2 text-sm text-gray-400",children:[e.jsx("span",{className:"font-semibold",children:"انقر للرفع"})," أو اسحب الصورة"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"SVG, PNG, JPG (بحد أقصى 2MB)"})]}),e.jsx("input",{id:"coverImage",type:"file",onChange:j,accept:"image/*",className:"hidden"})]})}),y&&e.jsx("img",{src:y,alt:"Cover preview",className:"mt-4 rounded-lg h-24 w-auto object-cover"})]})]}),z&&e.jsx("p",{className:"text-red-400 text-sm",children:z}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-800",children:e.jsxs("button",{type:"submit",className:"flex items-center gap-2 bg-amber-500 text-gray-900 font-bold px-6 py-3 rounded-lg hover:bg-amber-400 focus:outline-none focus:ring-4 focus:ring-amber-500/50 transition-colors",children:[e.jsx(ne,{size:20}),e.jsx("span",{children:C?"حفظ التعديلات":"نشر القصة"})]})})]})]})},Qe=new Ve({apiKey:"AIzaSyARVpPfEigrWISzW5NKKcNZGsrKGl5M4cc"}),et=async t=>{const l=`أنت روائي محترف متخصص في كتابة القصص الطويلة والمثيرة التي تبقي القارئ على حافة مقعده. مهمتك هي توليد قصة واقعية ومفصلة ومليئة بالتشويق.
يجب أن تكون الاستجابة بصيغة JSON تحتوي على الحقول التالية بالضبط:
- "title": (string) عنوان جذاب وغامض للقصة.
- "content": (string) محتوى القصة الكامل، يجب أن يكون مفصلاً وغنياً بالأحداث، ولا يقل عن 500 كلمة. يجب أن تحتوي القصة على حبكة متصاعدة وذروة مثيرة ونهاية مرضية.
- "category": (string) واحدة من هذه التصنيفات بالضبط: ${U.join(", ")}.
لا تضف أي نص خارج كائن JSON.`;try{let n=(await Qe.models.generateContent({model:"gemini-2.5-flash-preview-04-17",contents:`قم بإنشاء قصة بناءً على الفكرة التالية: "${t}"`,config:{systemInstruction:l,responseMimeType:"application/json",temperature:.8}})).text.trim();const s=/^```(\w*)?\s*\n?(.*?)\n?\s*```$/s,r=n.match(s);r&&r[2]&&(n=r[2].trim());const a=JSON.parse(n);if(a.title&&a.content&&a.category&&U.includes(a.category))return{title:a.title,content:a.content,category:a.category};throw console.error("Generated data from AI is missing required fields or has an invalid category.",a),new Error("البيانات المولّدة من الذكاء الاصطناعي غير مكتملة.")}catch(d){throw console.error("Error generating story with Gemini:",d),new Error("حدث خطأ أثناء توليد القصة. يرجى المحاولة مرة أخرى.")}},tt=()=>e.jsxs("div",{className:"absolute inset-0 bg-gray-800/80 backdrop-blur-sm flex flex-col justify-center items-center z-20 rounded-xl",children:[e.jsx(Y,{}),e.jsx("p",{className:"text-amber-400 text-lg mt-4 font-semibold",children:"جاري كتابة قصتك، لحظات من فضلك..."})]}),st=()=>{const t=O(),{createStory:l,currentUser:d}=L(),[n,s]=i.useState(""),[r,a]=i.useState(!1),[x,u]=i.useState(""),[b,o]=i.useState(null),c=async()=>{if(!n.trim()){u("الرجاء إدخال فكرة للقصة.");return}u(""),a(!0),o(null);try{const h=await et(n);h&&o(h)}catch(h){u(h.message||"حدث خطأ غير متوقع.")}finally{a(!1)}},y=h=>{if(h.preventDefault(),!b||!d)return;const z=l({...b,authorId:d.id});t(`/story/${z.id}`)};return e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"relative p-8 bg-gray-900 rounded-xl shadow-lg border border-gray-800 mb-8",children:[e.jsx(M,{children:r&&e.jsx(tt,{})}),e.jsxs("h1",{className:"text-3xl font-bold text-amber-400 mb-2 flex items-center gap-3",children:[e.jsx(ee,{size:32})," توليد قصة بالذكاء الاصطناعي"]}),e.jsx("p",{className:"text-gray-400 mb-6",children:"أدخل فكرة بسيطة، ودع السحر يبدأ. سيقوم الذكاء الاصطناعي بكتابة قصة فريدة من أجلك."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"prompt",className:"block text-gray-300 mb-2 font-medium",children:"فكرتك"}),e.jsx("textarea",{id:"prompt",value:n,onChange:h=>s(h.target.value),placeholder:"مثال: قطة فضائية تائهة على كوكب المريخ تبحث عن طريق العودة إلى مجرتها...",className:"w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber-500 transition-colors",rows:3,disabled:r})]}),x&&e.jsx("p",{className:"text-red-400 text-sm",children:x}),e.jsxs("button",{onClick:c,disabled:r,className:"w-full flex items-center justify-center gap-2 bg-amber-500 text-gray-900 font-bold px-6 py-3 rounded-lg hover:bg-amber-400 focus:outline-none focus:ring-4 focus:ring-amber-500/50 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed",children:[e.jsx(Ee,{size:20}),e.jsx("span",{children:"ولّد القصة"})]})]})]}),e.jsx(M,{children:b&&e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-8 bg-gray-900 rounded-xl shadow-lg border border-gray-800",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"مراجعة ونشر"}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-gray-300 mb-2 font-medium",children:"العنوان"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"title",type:"text",value:b.title,onChange:h=>o({...b,title:h.target.value}),className:"w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-3 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500"}),e.jsx(se,{className:"absolute top-1/2 -translate-y-1/2 start-3 text-gray-400",size:20})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"content",className:"block text-gray-300 mb-2 font-medium",children:"المحتوى"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{id:"content",value:b.content,onChange:h=>o({...b,content:h.target.value}),className:"w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-3 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500",rows:15}),e.jsx(re,{className:"absolute top-4 start-3 text-gray-400",size:20})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-gray-300 mb-2 font-medium",children:"التصنيف"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{id:"category",value:b.category,onChange:h=>o({...b,category:h.target.value}),className:"appearance-none w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-3 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500",children:U.map(h=>e.jsx("option",{value:h,children:h},h))}),e.jsx(ae,{className:"absolute top-1/2 -translate-y-1/2 start-3 text-gray-400",size:20})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-800",children:e.jsxs("button",{type:"submit",className:"flex items-center gap-2 bg-green-600 text-white font-bold px-6 py-3 rounded-lg hover:bg-green-500 focus:outline-none focus:ring-4 focus:ring-green-500/50 transition-colors",children:[e.jsx(ne,{size:20}),e.jsx("span",{children:"نشر القصة"})]})})]})]})})]})},rt=()=>{var C;const{userId:t}=X(),{getUser:l,currentUser:d,stories:n,updateUserAvatar:s}=L(),[r,a]=i.useState("written"),x=i.useRef(null),u=i.useMemo(()=>t?l(t):void 0,[t,l]),b=(d==null?void 0:d.id)===(u==null?void 0:u.id),o=i.useMemo(()=>n.filter(j=>j.authorId===t),[n,t]),c=i.useMemo(()=>n.filter(j=>j.likes.includes(t||"")),[n,t]),y=i.useMemo(()=>{const j=new Set;return n.forEach(w=>{w.comments.some(f=>f.authorId===t)&&j.add(w.id)}),n.filter(w=>j.has(w.id))},[n,t]),h=j=>{var f;const w=(f=j.target.files)==null?void 0:f[0];if(w&&u){const S=new FileReader;S.onloadend=()=>{s(u.id,S.result)},S.readAsDataURL(w)}};if(!u)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(Y,{})});const z=[{id:"written",label:`قصصه (${o.length})`,icon:Pe,data:o},{id:"liked",label:`أعجبه (${c.length})`,icon:W,data:c},{id:"commented",label:`علّق عليها (${y.length})`,icon:Te,data:y}],N=((C=z.find(j=>j.id===r))==null?void 0:C.data)||[];return e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsxs("div",{className:"relative bg-gray-900 p-8 rounded-xl shadow-lg mb-8 overflow-hidden border border-gray-800",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1/2 bg-cover bg-center opacity-30",style:{backgroundImage:`url(https://picsum.photos/seed/${u.id}/1200/400)`}}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-t from-gray-900 to-transparent"}),e.jsxs("div",{className:"relative z-10 flex flex-col sm:flex-row items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(E,{src:u.avatar,alt:u.name,size:"lg"}),b&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:x,onChange:h,accept:"image/*",className:"hidden"}),e.jsx("button",{onClick:()=>{var j;return(j=x.current)==null?void 0:j.click()},className:"absolute bottom-0 end-0 bg-amber-500 p-2 rounded-full text-gray-900 hover:bg-amber-400 transition-colors shadow-lg",title:"تغيير الصورة الرمزية",children:e.jsx(Ue,{size:16})})]})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white text-center sm:text-start",children:u.name}),e.jsx("p",{className:"text-gray-400 mt-1 text-center sm:text-start",children:"عضو في مجتمع حكايات"})]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex border-b border-gray-800",children:z.map(({id:j,label:w,icon:f})=>e.jsxs("button",{onClick:()=>a(j),className:`relative flex items-center gap-2 px-4 py-3 font-semibold transition-colors ${r===j?"text-amber-400":"text-gray-400 hover:text-white"}`,children:[e.jsx(f,{size:18}),e.jsx("span",{children:w}),r===j&&e.jsx(k.div,{className:"absolute bottom-0 right-0 left-0 h-0.5 bg-amber-400",layoutId:"underline"})]},j))})}),e.jsx("div",{children:e.jsx(M,{mode:"wait",children:e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:N.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:N.map(j=>e.jsx(G,{story:j},j.id))}):e.jsxs("div",{className:"text-center py-16 bg-gray-900 rounded-lg border border-gray-800",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"لا توجد قصص لعرضها في هذا القسم."}),e.jsxs("p",{className:"text-gray-500 mt-1",children:["عندما يتفاعل ",u.name," مع القصص، ستظهر هنا."]})]})},r)})})]})},at=()=>{const[t,l]=i.useState(""),[d,n]=i.useState(""),{login:s}=L(),r=O(),a=x=>{if(x.preventDefault(),!t.trim()){n("الرجاء إدخال اسم.");return}n(""),s(t),r("/")};return e.jsxs("div",{className:"min-h-[calc(100vh-80px)] flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute -top-1/2 -right-1/2 w-96 h-96 bg-amber-500/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute -bottom-1/2 -left-1/2 w-96 h-96 bg-amber-500/10 rounded-full blur-3xl animate-pulse animation-delay-4000"}),e.jsx(k.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative w-full max-w-md p-1 bg-gradient-to-br from-amber-500/50 via-gray-800 to-gray-800 rounded-xl",children:e.jsxs("div",{className:"w-full bg-gray-900 rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-amber-400",children:"أهلاً بك في حكايات"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"أدخل اسمك للمتابعة أو لإنشاء حساب جديد."})]}),e.jsxs("form",{onSubmit:a,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-300 mb-2 font-medium",children:"الاسم"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"name",type:"text",value:t,onChange:x=>l(x.target.value),className:"w-full bg-gray-800 border-2 border-gray-700 rounded-lg py-3 ps-10 pe-4 text-white focus:outline-none focus:border-amber-500 transition-colors",placeholder:"مثال: شهريار",required:!0}),e.jsx(q,{className:"absolute top-1/2 -translate-y-1/2 start-3 text-gray-400",size:20})]}),d&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:d})]}),e.jsx("button",{type:"submit",className:"w-full bg-amber-500 text-gray-900 font-bold py-3 rounded-lg hover:bg-amber-400 focus:outline-none focus:ring-4 focus:ring-amber-500/50 transition-all duration-300",children:"دخول"})]})]})})]})},nt=()=>e.jsx(He,{children:e.jsx(Oe,{children:e.jsx(qe,{children:e.jsx(M,{mode:"wait",children:e.jsxs(Fe,{children:[e.jsx(D,{path:"/",element:e.jsx(We,{})}),e.jsx(D,{path:"/story/:storyId",element:e.jsx(Ze,{})}),e.jsx(D,{path:"/profile/:userId",element:e.jsx(rt,{})}),e.jsx(D,{path:"/login",element:e.jsx(at,{})}),e.jsx(D,{path:"/create",element:e.jsx(J,{children:e.jsx(Q,{})})}),e.jsx(D,{path:"/edit/:storyId",element:e.jsx(J,{children:e.jsx(Q,{})})}),e.jsx(D,{path:"/generate",element:e.jsx(J,{children:e.jsx(st,{})})})]})})})})}),ie=document.getElementById("root");if(!ie)throw new Error("Could not find root element to mount to");const ot=Re.createRoot(ie);ot.render(e.jsx(Ge.StrictMode,{children:e.jsx(nt,{})}));
